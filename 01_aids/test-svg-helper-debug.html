<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Helper Debug</title>
</head>
<body>
    <h1>SVG Helper Debug</h1>
    <div id="result"></div>
    
    <script>
        window.DISEASE_TYPE = 'aids';
        
        function updateResult(message) {
            document.getElementById('result').innerHTML += message + '<br>';
        }
        
        updateResult('Loading SVG Helper...');
        
        // エラーキャプチャ
        window.addEventListener('error', (event) => {
            updateResult(`❌ Error: ${event.error?.message || event.message}`);
            updateResult(`File: ${event.filename}:${event.lineno}:${event.colno}`);
            if (event.error?.stack) {
                updateResult(`Stack: ${event.error.stack.substring(0, 200)}...`);
            }
        });
        
        // SVG Helper を読み込み
        const script = document.createElement('script');
        script.src = '../shared/assets/js/utils/svg-helper.js';
        
        script.onload = () => {
            updateResult('✅ SVG Helper script loaded');
            
            // window.SVGHelper の存在確認
            setTimeout(() => {
                if (window.SVGHelper) {
                    updateResult('✅ window.SVGHelper exists');
                    updateResult(`Type: ${typeof window.SVGHelper}`);
                    updateResult(`Constructor: ${window.SVGHelper.constructor.name}`);
                    
                    // メソッドの存在確認
                    const methods = ['initSVG', 'getResponsiveDimensions', 'setupResponsiveSVG'];
                    methods.forEach(method => {
                        if (typeof window.SVGHelper[method] === 'function') {
                            updateResult(`✅ Method ${method} exists`);
                        } else {
                            updateResult(`❌ Method ${method} missing`);
                        }
                    });
                    
                } else {
                    updateResult('❌ window.SVGHelper does not exist');
                    updateResult('Checking alternatives...');
                    
                    // 他の可能性をチェック
                    if (window.SvgHelper) {
                        updateResult('Found window.SvgHelper (different case)');
                    }
                    if (window.SVGHelper === undefined) {
                        updateResult('window.SVGHelper is undefined');
                    }
                    if (window.SVGHelper === null) {
                        updateResult('window.SVGHelper is null');
                    }
                    
                    // window オブジェクトの中身を調査
                    const windowKeys = Object.keys(window).filter(key => key.toLowerCase().includes('svg'));
                    updateResult(`SVG-related keys in window: ${windowKeys.join(', ')}`);
                }
            }, 100);
        };
        
        script.onerror = (error) => {
            updateResult('❌ Failed to load SVG Helper script');
        };
        
        document.head.appendChild(script);
    </script>
</body>
</html>