<!DOCTYPE html>
<html>
<head>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="assets/js/utils/app-constants.js"></script>
    <script src="assets/js/utils/color-scheme.js"></script>
</head>
<body>
    <h1>直接テスト</h1>
    <div id="test"></div>
    
    <script>
        // 即座にテスト
        setTimeout(() => {
            const testDiv = document.getElementById('test');
            
            console.log('=== Direct Test Start ===');
            
            // 1. ColorScheme作成
            if (window.ColorScheme) {
                const colorScheme = new ColorScheme();
                testDiv.innerHTML += '<p>ColorScheme作成: OK</p>';
                
                // 2. 地域色テスト
                const testRegions = ['アジア・太平洋地域', '東部・南部アフリカ'];
                testRegions.forEach(region => {
                    const color = colorScheme.getRegionColor(region);
                    testDiv.innerHTML += `<p>${region}: ${color} <span style="display:inline-block;width:20px;height:20px;background:${color};border:1px solid black;"></span></p>`;
                    console.log(`${region} -> ${color}`);
                });
                
                // 3. D3カラースケールテスト
                const series = [
                    { name: 'アジア・太平洋地域' },
                    { name: '東部・南部アフリカ' }
                ];
                
                const regionColors = series.map(s => {
                    const color = colorScheme.getRegionColor(s.name);
                    console.log(`D3 Test: ${s.name} -> ${color} (type: ${typeof color})`);
                    return color;
                });
                
                console.log('Region colors array:', regionColors);
                
                const colorScale = d3.scaleOrdinal()
                    .domain(series.map(s => s.name))
                    .range(regionColors);
                
                series.forEach(s => {
                    const scaledColor = colorScale(s.name);
                    testDiv.innerHTML += `<p>D3 Scaled ${s.name}: ${scaledColor} <span style="display:inline-block;width:20px;height:20px;background:${scaledColor};border:1px solid black;"></span></p>`;
                    console.log(`D3 Scaled: ${s.name} -> ${scaledColor}`);
                });
                
            } else {
                testDiv.innerHTML += '<p>ColorSchemeクラスがありません</p>';
            }
            
            console.log('=== Direct Test End ===');
        }, 100);
    </script>
</body>
</html>